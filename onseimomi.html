<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>YouTubeéŸ³å£°ã®ã¿ï¼‹éŸ³å£°èªè­˜UI</title>
  <style>
    body { font-family: sans-serif; padding: 20px; text-align: center; background: #f0f4f8; }
    iframe { display: none; } /* æ˜ åƒã‚’éè¡¨ç¤ºã«ã—ã¦è»½ãã™ã‚‹ */
    input, button {
      font-size: 18px;
      padding: 8px;
      width: 80%;
      margin: 10px auto;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    #recognized, #resultList {
      font-size: 18px;
      margin: 10px auto;
      max-width: 600px;
      background: #fff;
      padding: 10px;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
      text-align: left;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <h1>ğŸ§ éŸ³å£°ã®ã¿ã§ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ç·´ç¿’</h1>
  <p>ğŸ”Š YouTubeéŸ³å£°ã‚’æµã—ã¦ã€èãå–ã£ãŸå†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>
  <iframe id="ytplayer" src="https://www.youtube.com/embed/M7lc1UVf-VE?autoplay=1" allow="autoplay" allowfullscreen></iframe>
  <div id="recognized">ğŸ—£ï¸ èªè­˜ä¸­â€¦</div>
  <input type="text" id="typingInput" placeholder="Enterã§åˆ¤å®š"><br>
  <div id="resultList">ğŸ“‹ çµæœï¼š</div>

  <script>
    let recognition;
    let transcript = \"\";
    let lastCapture = \"\";

    function startRecognition() {
      if (!('webkitSpeechRecognition' in window)) {
        alert(\"Chromeã§é–‹ã„ã¦ãã ã•ã„\");
        return;
      }

      recognition = new webkitSpeechRecognition();
      recognition.lang = \"ja-JP\";
      recognition.continuous = true;
      recognition.interimResults = true;

      recognition.onresult = function(event) {
        for (let i = event.resultIndex; i < event.results.length; i++) {
          transcript = event.results[i][0].transcript.trim();
        }
        document.getElementById(\"recognized\").textContent = \"ğŸ—£ï¸ \" + transcript;
      };

      recognition.onerror = (e) => console.error(\"èªè­˜ã‚¨ãƒ©ãƒ¼:\", e);
      recognition.onend = () => {
        console.log(\"èªè­˜ãŒçµ‚äº†ã€å†èµ·å‹•\");
        startRecognition();
      };

      recognition.start();
    }

    document.getElementById(\"typingInput\").addEventListener(\"keydown\", function(e) {
      if (e.key === \"Enter\") {
        const input = this.value.trim();
        const correct = transcript.trim();
        let match = 0;
        for (let i = 0; i < Math.min(input.length, correct.length); i++) {
          if (input[i] === correct[i]) match++;
        }
        const rate = correct.length ? (match / correct.length * 100).toFixed(1) : 0;
        const log = `ğŸ¯ ä¸€è‡´ç‡: ${rate}%\\nğŸ§ éŸ³å£°: ${correct}\\nâŒ¨ï¸ å…¥åŠ›: ${input}`;
        const result = document.getElementById(\"resultList\");
        result.textContent = `${log}\\n------------------------\\n` + result.textContent;
        this.value = \"\";
      }
    });

    window.onload = startRecognition;
  </script>
</body>
</html>
